---
import { Image } from "@astrojs/image/components";
import LogoAnimation from "../components/LogoAnimation.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import ceas from "/public/images/sponsors/ceas.jpg";
import usg from "/public/images/sponsors/usg.png";
import mecheng from "/public/images/sponsors/mecheng.png";
import solidworks from "/public/images/sponsors/solidworks.svg";
import ansys from "/public/images/sponsors/ansys.svg";
import kisssoft from "/public/images/sponsors/kisssoft.svg";
import hexagon from "/public/images/sponsors/hexagon.png";
import mastercam from "/public/images/sponsors/Mastercam.svg";
import kenesto from "/public/images/sponsors/kenesto.png";
import flagpoles from "/public/images/sponsors/flagpoles.gif";
import fourxpro from "/public/images/sponsors/4xpro.avif";
import ghaas from "/public/images/sponsors/ghaas.png";
import basebrooklyn from "/public/images/sponsors/basebrooklyn.webp";
import burton from "/public/images/sponsors/burton.png";
import maloya from "/public/images/sponsors/maloya.webp";
import difinishing from "/public/images/sponsors/di_finishing.png";
import kkfinishing from "/public/images/sponsors/kkfinishing.png";
---
<LogoAnimation />

<BaseLayout>
  <!-- HERO -->
  <header class="hero">
    <div class="hero-content">
      <h1 class="hero-title">Stony Brook Motorsports</h1>
      <p class="hero-sub">A Racing Team with History</p>
      <a href="/past-cars" class="btn-cta">
        See how we placed at Baja 2025
        <span class="arrow-circle"></span>
      </a>
    </div>
  </header>

  <!-- JOIN + RECAP buttons in navbar slot (in BaseLayout, under .nav-right) -->
  <!-- Example: -->
  <!-- <a href="/join" class="btn-secondary">Join the Team</a> -->
  <!-- <a href="/last-baja" class="btn-secondary">Baja 2026 Recap</a> -->

  <!-- STATS BAR -->
  <section class="stat-bar">
    <div class="stat-item" data-target="75">
      <h3>0</h3><p>Active Members</p>
    </div>
    <div class="stat-item" data-target="20">
      <h3>0</h3><p>Competitions</p>
    </div>
    <div class="stat-item" data-target="120">
      <h3>0</h3><p>Projects</p>
    </div>
  </section>

  <!-- ABOUT THE TEAM -->
  <section class="about">
    <h2>Get to Know Us</h2>
    <p>
      We're a multidisciplinary student team passionate about building off-road race cars from scratch.<br>
      We push the limits of engineering and teamwork  all while forging lifelong friendships.
    </p>
    <!-- moved into navbar -->
  </section>

  <section id="sponsors" class="sponsors">
	<h3>Our Sponsors</h3>
  
	<!-- Platinum Tier -->
	<div class="sponsor-tier platinum">
	  <h4>Platinum</h4>
	  <div class="sponsor-grid">
		<div class="logo-box">
		  <a href="https://www.stonybrook.edu/ceas/" target="_blank">
			<Image src={ceas} alt="Stony Brook College of Engineering & Applied Sciences" />
		  </a>
		</div>
		<div class="logo-box">
		  <a href="https://stonybrookusg.com/" target="_blank">
			<Image src={usg} alt="Stony Brook USG" />
		  </a>
		</div>
		<div class="logo-box">
		  <a href="https://www.stonybrook.edu/undergraduate-admissions/programs/mec.php" target="_blank">
			<Image src={mecheng} alt="Stony Brook Mechanical Engineering" />
		  </a>
		</div>
		<div class="logo-box">
		  <a href="https://www.solidworks.com/" target="_blank">
			<Image src={solidworks} alt="Solidworks" />
		  </a>
		</div>
	  </div>
	</div>
  
	<!-- Gold Tier -->
	<div class="sponsor-tier gold">
	  <h4>Gold</h4>
	  <div class="sponsor-grid">
		<div class="logo-box">
		<a href="https://www.ansys.com/" target="_blank">
			<Image src={ansys} alt="Ansys" />
		  </a>
		</div>
		<div class="logo-box">
		  <a href="https://www.kisssoft.com/en/" target="_blank">
			<Image src={kisssoft} alt="KISSsoft" />
		  </a>
		</div>
	
		<div class="logo-box">
		  <a href="https://hexagon.com/" target="_blank">
			<Image src={hexagon} alt="Hexagon" />
		  </a>
		</div>
		<div class="logo-box">
		  <a href="https://www.mastercam.com/" target="_blank">
			<Image src={mastercam} alt="Mastercam" />
		</a>

	  </div>
	</div>
  
	<!-- Silver Tier -->
	<div class="sponsor-tier silver">
	  <h4>Silver</h4>
	  <div class="sponsor-grid">
		<div class="logo-box">
			<a href="https://www.kenesto.com/" target="_blank">
			  <Image src={kenesto} alt="Kenesto" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="http://www.flagpolesinc.com/" target="_blank">
			  <Image src={flagpoles} alt="Flagpoles Inc" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="https://www.4xpro.com/" target="_blank">
			  <Image src={fourxpro} alt="4XPro" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="https://www.ghaasfoundation.org/" target="_blank">
			  <Image src={ghaas} alt="Gene Haas Foundation" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="https://base-brooklyn.myshopify.com/" target="_blank">
			  <Image src={basebrooklyn} alt="Base Brooklyn" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="https://burtonind.com/" target="_blank">
			  <Image src={burton} alt="Burton Industries Inc" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="https://maloyalaser.com/" target="_blank">
			  <Image src={maloya} alt="Maloya" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="/sponsors/difinishing" target="_blank">
			  <Image src={difinishing} alt="D&I Finishing Inc" />
			</a>
		  </div>
		  <div class="logo-box">
			<a href="http://www.kkfinishingco.com/" target="_blank">
			  <Image src={kkfinishing} alt="KK Finishing Inc" />
			</a>
		  </div>
	  </div>
	</div>
</section>
  
  
</BaseLayout>

<script type="module">
  window.addEventListener('DOMContentLoaded', () => {
    // Animation overlay removal
    const overlay = document.getElementById('animation-overlay');
    const logo    = document.getElementById('navbar-logo');
    const played  = sessionStorage.getItem('animationPlayed');
    if (overlay && !played) {
      overlay.style.pointerEvents = 'none';
      setTimeout(() => { overlay.remove(); logo.style.opacity = '1'; sessionStorage.setItem('animationPlayed','true'); }, 4000);
    } else overlay?.remove();

    // Stats count‑up on scroll
    const stats   = document.querySelectorAll('.stat-item');
    const animate = () => {
      stats.forEach((el) => {
        const rect = el.getBoundingClientRect();
        if (rect.top < window.innerHeight && !el.classList.contains('done')) {
          const target = +el.dataset.target;
          let count = 0;
          const h3    = el.querySelector('h3');
          const step  = Math.ceil(target / 50);
          const timer = setInterval(() => {
            count += step;
            if (count >= target) {
              count = target;
              clearInterval(timer);
              el.classList.add('done');
            }
            if (h3) h3.textContent = count + (el.classList.contains('done') ? '+' : '');
          }, 20);
        }
      });
    };
    window.addEventListener('scroll', animate);
    animate();

    // Sponsors fade
    const sp = document.getElementById('sponsors');
    const logos = document.querySelector('.sponsor-logos');
    window.addEventListener('scroll', () => {
      if (sp.getBoundingClientRect().top < window.innerHeight / 2) {
        logos?.classList.add('fade-to-white');
      }
    });
  });
</script>
<script type="module">
	document.addEventListener('DOMContentLoaded', () => {
	  const boxes = document.querySelectorAll('.logo-box');
	  const io = new IntersectionObserver((entries) => {
		entries.forEach(e => {
		  if (e.isIntersecting) {
			e.target.classList.add('reveal');
			io.unobserve(e.target);
		  }
		});
	  }, { threshold: 0.3 });
  
	  boxes.forEach(b => io.observe(b));
	});
  </script>
  
